function f(c){const e=c.querySelector("form"),o=c.querySelector("#newsletterFeedback"),n=c.dataset.errorText;if(!e||!o)return;function d(r,a){var s;r.classList.add("is-invalid"),r.setCustomValidity(a);const t=(s=r.closest(".js-form-field"))==null?void 0:s.querySelector(".invalid-feedback");t&&(t.textContent=a)}e.querySelectorAll("input, textarea").forEach(r=>{r.addEventListener("input",()=>{var t;r.classList.remove("is-invalid"),r.setCustomValidity("");const a=(t=r.closest(".js-form-field"))==null?void 0:t.querySelector(".invalid-feedback");a&&(a.textContent="")})}),e.addEventListener("submit",async r=>{if(r.preventDefault(),e.querySelectorAll(".is-invalid").forEach(t=>t.classList.remove("is-invalid")),e.querySelectorAll(".invalid-feedback").forEach(t=>t.textContent=""),o.innerHTML="",!e.checkValidity()){e.classList.add("was-validated");return}const a=new FormData(e);try{const s=await(await fetch("/api/newsletter/subscribe",{method:"POST",body:a})).json();if(s.success)o.innerHTML=`<div class="alert alert-success">${s.message}</div>`,e.reset(),e.classList.remove("was-validated"),e.querySelectorAll("input, textarea").forEach(i=>i.setCustomValidity(""));else if(s.errors){e.classList.add("was-validated");for(const i of Object.keys(s.errors)){const l=e.querySelector(`[name="${i}"]`);l&&s.errors[i]&&d(l,s.errors[i].join(", "))}}}catch(t){console.error(t),o.innerHTML=`<div class="alert alert-danger">${n}</div>`}})}export{f as default};
